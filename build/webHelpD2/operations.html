<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2021-11-22T21:44:51.632751"><meta name="build-number" content="135">    <meta name="keywords" content="">   <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5P98');</script><script src="https://resources.jetbrains.com/storage/help-app/v3/analytics.js"></script>  <title>Operations | Dataframe</title>   <link href="https://resources.jetbrains.com/storage/help-app/v3/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Operations | Dataframe"/><meta property="og:description" content=""/><meta property="og:image" content=""/><meta property="og:site_name" content="Dataframe Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="http://www.jetbrains.com/help//1.0/operations.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Operations | Dataframe"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "http://www.jetbrains.com/help//1.0/operations.html#webpage", "url": "http://www.jetbrains.com/help//1.0/operations.html", "name": "Operations | Dataframe", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "http://www.jetbrains.com/help/#website", "url": "http://www.jetbrains.com/help/", "name": "Dataframe Help" }</script><!-- End Schema.org --></head>    <body data-id="operations" data-main-title="Operations" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs=""  >  <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Dataframe 1.0 Help</h3><div class="shortcuts-switcher"><label for="switch-shortcuts">Keymap:</label><select class="select _shortcuts" height="1" id="switch-shortcuts">  </select></div><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="operations" id="operations.md"  >Operations</h1><p id="fe8ebd13" ><code class="code "   >DataFrame</code> transformation pipeline usually consists of several modification operations, such as filtering, sorting, grouping, pivoting, adding/removing columns etc. <code class="code "   >DataFrame</code> API is designed in functional style so that the whole processing pipeline can be represented as a single statement with a sequential chain of operations. <code class="code "   >DataFrame</code> object is immutable, so all operations defined for <code class="code "   >DataFrame</code> object return a new <code class="code "   >DataFrame</code> instance that reusing underlying data structures as much as possible.</p><section class="chapter"  ><h2 id="multiplex-operations" data-toc="operations#multiplex-operations"  >Multiplex operations</h2><p id="259defa5" >Simple operations (such as <a href="filter.html" id="7d82a54c"   ><code class="code "   >filter</code></a> or <a href="select.html" id="efc4adbc"   ><code class="code "   >select</code></a>) return <code class="code "   >DataFrame</code>, but more complex operations return an intermediate object that is used for further configuration of the operation. Let's call such operations <b id="57861d08" class=""  >multiplex</b>.</p><div class="code-block" data-lang="kotlin"          >df.update { age }.where { city == &quot;Paris&quot; }.with { it - 5 }
    .move { name.firstName and name.lastName }.after { isHappy }
    .merge { age and weight }.by { &quot;Age: ${it[0]}, weight: ${it[1]}&quot; }.into(&quot;info&quot;)
    .rename { isHappy }.into(&quot;isOkay&quot;)
</div><p id="26c72890" >First call in configuration chain for multiplex operation selects a subset of columns in <code class="code "   >DataFrame</code> for which that operation should be applied. To select columns you can use <a href="stringapi.html" id="bf051448"   >String API</a> or <a href="columnselectors.html" id="1861f3fc"   >Column Selectors</a>.</p><p id="1c0b9165" >Further operation configuration API may vary depending on types of selected columns.</p><p id="24d7f863" >Multiplex operations usually end with call to <code class="code "   >into</code> or <code class="code "   >with</code> function. The following naming convention is used:</p><ul class="list _ul" id="8d5c4177"   ><li class="list__item" id="239443f6" ><p><code class="code "   >into</code> defines column names where operation results should be stored. Used in <a href="move.html" id="1fa1dc1d"   ><code class="code "   >move</code></a>, <a href="group.html" id="92b241b5"   ><code class="code "   >group</code></a>, <a href="split.html" id="cd3b0f1f"   ><code class="code "   >split</code></a>, <a href="merge.html" id="b3b19999"   ><code class="code "   >merge</code></a>, <a href="gather.html" id="bb96eceb"   ><code class="code "   >gather</code></a>, <a href="groupby.html" id="b162dd7c"   ><code class="code "   >groupBy</code></a>, <a href="rename.html" id="2af3bd1"   ><code class="code "   >rename</code></a>.</p></li><li class="list__item" id="f4deffc8" ><p><code class="code "   >with</code> defines row-wise data transformation using <a href="datarow.html#row-expressions" id="da2b1f06"   ><code class="code "   >row expression</code></a>. Used in <a href="update.html" id="b1f30172"   ><code class="code "   >update</code></a>, <a href="convert.html" id="31d4f7b8"   ><code class="code "   >convert</code></a>, <a href="replace.html" id="81c40b26"   ><code class="code "   >replace</code></a>, <a href="pivot.html" id="8b64c362"   ><code class="code "   >pivot</code></a>.</p></li></ul></section><section class="chapter"  ><h2 id="list-of-dataframe-operations" data-toc="operations#list-of-dataframe-operations"  >List of DataFrame operations</h2><ul class="list _ul" id="dff65c3"   ><li class="list__item" id="63f65d9" ><p><a href="add.html" id="cc618b61"   >add</a>- add columns</p></li><li class="list__item" id="61189338" ><p><a href="append.html" id="dc2d060a"   >append</a>- add rows</p></li><li class="list__item" id="7d7b51ee" ><p><a href="columns.html" id="cff1b9c6"   >columns</a>- get list of columns</p></li><li class="list__item" id="2154a301" ><p><a href="concat.html" id="1ef29f91"   >concat</a>- union rows</p></li><li class="list__item" id="2fb69704" ><p><a href="convert.html" id="859b676c"   >convert</a>- change column values and/or column types</p></li><li class="list__item" id="d05f9869" ><p><a href="describe.html" id="2d8072fd"   >describe</a>- basic column statistics</p></li><li class="list__item" id="b81b4b50" ><p><a href="distinct.html" id="1072f74d"   >distinct</a>/ <a href="distinct.html#distinctby" id="e89822a2"   >distinctBy</a>- remove duplicated rows</p></li><li class="list__item" id="6f404b6f" ><p><a href="drop.html" id="9390d0b6"   >drop</a>/ <a href="slicerows.html#droplast" id="e3479311"   >dropLast</a>/ <a href="drop.html#dropnulls" id="c64dc9d8"   >dropNulls</a>/ <a href="drop.html#dropna" id="6e725f3e"   >dropNa</a>- remove rows be condition</p></li><li class="list__item" id="3d59396b" ><p><a href="explode.html" id="57425ce7"   >explode</a>- spread list-like values vertically</p></li><li class="list__item" id="97bd9e75" ><p><a href="fill.html#fillnulls" id="96eb07e7"   >fillNulls</a>/ <a href="fill.html#fillnans" id="60dd2db"   >fillNaNs</a>/ <a href="fill.html#fillna" id="dc666a98"   >fillNA</a>- replace missing values</p></li><li class="list__item" id="cd9418a0" ><p><a href="filter.html" id="51df8541"   >filter</a>/ <a href="filter.html#filterby" id="ed1efacd"   >filterBy</a>- filter rows</p></li><li class="list__item" id="23acddd9" ><p><a href="first.html" id="8c2eec05"   >first</a>/ <a href="first.html#firstornull" id="93df3ff4"   >firstOrNull</a>- first row by condition</p></li><li class="list__item" id="e099a2c5" ><p><a href="flatten.html" id="9259ade0"   >flatten</a>- remove column groupings recursively</p></li><li class="list__item" id="2041d3db" ><p><a href="iterate.html" id="21fa3f2b"   >forEachRow</a>/ <a href="iterate.html" id="563725a9"   >forEachColumn</a>- iterate over rows or columns</p></li><li class="list__item" id="d2daf639" ><p><a href="format.html" id="d22d9b22"   >format</a>- conditional formatting for cell rendering</p></li><li class="list__item" id="55ecc588" ><p><a href="gather.html" id="49e253a7"   >gather</a>- convert columns into key-value pairs</p></li><li class="list__item" id="6a4dded9" ><p><a href="getcolumn.html" id="4288e52d"   >getColumn</a>/ <a href="getcolumn.html#getcolumnornull" id="ba334958"   >getColumnOrNull</a>/ <a href="getcolumn.html#getcolumngroup" id="8b26d855"   >getColumnGroup</a>/ <a href="getcolumn.html#getcolumns" id="27e17173"   >getColumns</a>- get one or several columns</p></li><li class="list__item" id="244e7a5f" ><p><a href="group.html" id="a5693c08"   >group</a>- group columns into <a href="datacolumn.html#columngroup" id="82ae5f19"   ><code class="code "   >ColumnGroup</code></a></p></li><li class="list__item" id="161d1d39" ><p><a href="groupby.html" id="eb8854d6"   >groupBy</a>- group rows by key columns</p></li><li class="list__item" id="7d4119ca" ><p><a href="head.html" id="71b480c7"   >head</a>- top 5 rows</p></li><li class="list__item" id="38312b93" ><p><a href="implode.html" id="a2c552cb"   >implode</a>- collapse column values into lists</p></li><li class="list__item" id="38f58d97" ><p><a href="insert.html" id="e440430b"   >insert</a>- insert column</p></li><li class="list__item" id="18809029" ><p><a href="join.html" id="e42269e7"   >join</a>- join dataframes by key columns</p></li><li class="list__item" id="3595ca27" ><p><a href="last.html" id="2af721c8"   >last</a>/ <a href="last.html#lastornull" id="9de5c859"   >lastOrNull</a>- last row by condition</p></li><li class="list__item" id="dc9ecf9e" ><p><a href="map.html" id="d0fe6f02"   >map</a>- map <a href="dataframe.html" id="2b7f70c"   ><code class="code "   >DataFrame</code></a> columns to a new <a href="dataframe.html" id="a66e1a83"   ><code class="code "   >DataFrame</code></a> or <a href="datacolumn.html" id="b4e0d4de"   ><code class="code "   >DataColumn</code></a></p></li><li class="list__item" id="61196942" ><p><a href="minmax.html" id="a82631d"   >max</a>/ <a href="minmax.html" id="73ed874d"   >maxBy</a>/ <a href="minmax.html" id="a1da63ed"   >maxOf</a>/ <a href="minmax.html" id="371784d4"   >maxFor</a>- max of values</p></li><li class="list__item" id="e3c8c8c6" ><p><a href="mean.html" id="fbb3a3c5"   >mean</a>/ <a href="mean.html" id="f42bccdb"   >meanOf</a>/ <a href="mean.html" id="3e8871ed"   >meanFor</a>- average of values</p></li><li class="list__item" id="661a3211" ><p><a href="median.html" id="2d7fb9a4"   >median</a>/ <a href="median.html" id="d5aa5f28"   >medianOf</a>/ <a href="median.html" id="ec9425b7"   >medianFor</a>- median of values</p></li><li class="list__item" id="a476977" ><p><a href="merge.html" id="687c780c"   >merge</a>- merge several columns into one</p></li><li class="list__item" id="f0cf6721" ><p><a href="minmax.html" id="9eb351c5"   >min</a>/ <a href="minmax.html" id="357534e9"   >minBy</a>/ <a href="minmax.html" id="bc05dcfa"   >minOf</a>/ <a href="minmax.html" id="97b0f313"   >minFor</a>- min of values</p></li><li class="list__item" id="36247b42" ><p><a href="move.html" id="18bfeef1"   >move</a>- move columns or change column groupings</p></li><li class="list__item" id="8117c197" ><p><a href="ncol.html" id="9f970b0e"   >ncol</a>- number of columns</p></li><li class="list__item" id="73ed168" ><p><a href="parse.html" id="4f1d0e17"   >parse</a>- convert <code class="code "   >String</code> values into appropriate types</p></li><li class="list__item" id="74620ec" ><p><a href="pivot.html" id="43777738"   >pivot</a>- convert column values into new columns</p></li><li class="list__item" id="cbc33e85" ><p><a href="remove.html" id="fcb46d1e"   >remove</a>- remove columns</p></li><li class="list__item" id="be31fc91" ><p><a href="rename.html" id="51053467"   >rename</a>- rename columns</p></li><li class="list__item" id="f4c7f1ed" ><p><a href="replace.html" id="a9cc86b0"   >replace</a>- replace columns</p></li><li class="list__item" id="fc3ca873" ><p><a href="rows.html" id="3159c197"   >rows</a>/ <a href="rows.html#rowsreversed" id="972b89aa"   >rowsReversed</a></p></li><li class="list__item" id="e04f2aab" ><p><a href="schema.html" id="f1d9225c"   >schema</a>- schema of column hierarchy</p></li><li class="list__item" id="976723c6" ><p><a href="select.html" id="997b7f25"   >select</a>- select subset of columns</p></li><li class="list__item" id="2b6deac7" ><p><a href="shuffle.html" id="d7a1d46e"   >shuffled</a>- reorder rows randomly</p></li><li class="list__item" id="c31acb0b" ><p><a href="single.html" id="72c42e7a"   >single</a>/ <a href="single.html#singleornull" id="6be00420"   >singleOrNull</a>- single row by condition</p></li><li class="list__item" id="76ef1a67" ><p><a href="sortby.html" id="b7df687e"   >sortBy</a>/ <a href="sortby.html#sortbydesc" id="db02275a"   >sortByDesc</a>/ <a href="sortby.html#sortwith" id="10fea84c"   >sortWith</a>- sort rows</p></li><li class="list__item" id="9afa5726" ><p><a href="split.html" id="3b91af78"   >split</a>- split column values into several columns or new rows</p></li><li class="list__item" id="72dd2832" ><p><a href="std.html" id="3e3443af"   >std</a>/ <a href="std.html" id="a7de5e6e"   >stdOf</a>/ <a href="std.html" id="f96375fc"   >stdFor</a>- standard deviation of values</p></li><li class="list__item" id="3075278d" ><p><a href="sum.html" id="b4e9550d"   >sum</a>/ <a href="sum.html" id="128e36e9"   >sumOf</a>/ <a href="sum.html" id="9bebe874"   >sumFor</a>- sum of values</p></li><li class="list__item" id="c8ac0fb6" ><p><a href="slicerows.html#take" id="1aaeaa60"   >take</a>/ <a href="slicerows.html#takelast" id="1ee7786e"   >takeLast</a>- first/last rows</p></li><li class="list__item" id="1a5ac49f" ><p><a href="ungroup.html" id="85dd10a0"   >ungroup</a>- remove column grouping</p></li><li class="list__item" id="4f0e16eb" ><p><a href="update.html" id="1f95ca86"   >update</a>- change column values preserving column types</p></li></ul></section><div class="last-modified"> Last modified: 22 November 2021</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="datarow.html">DataRow</a>   <a class="navigation-links__next" href="create.html">Create</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/storage/help-app/v3/app.js"></script></body></html>