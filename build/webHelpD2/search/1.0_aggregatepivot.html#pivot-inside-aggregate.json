{"objectID":"1.0_aggregatepivot.html#pivot-inside-aggregate","parent":"1.0_aggregatepivot.html","pageViews":0,"url":"http://www.jetbrains.com/help///1.0/aggregatepivot.html#pivot-inside-aggregate","version":"1.0","product":"","headings":"Pivot inside aggregate","content":"df.groupBy { name.firstName }.aggregate { pivot { city }.aggregate(separate \u003d true) { mean { age } into \"mean age\" count() into \"count\" } count() into \"total\" } val city by column\u003cString?\u003e() val name by columnGroup() val firstName by name.column\u003cString\u003e() val age by column\u003cInt\u003e() df.groupBy { firstName }.aggregate { pivot { city }.aggregate(separate \u003d true) { mean { age } into \"mean age\" count() into \"count\" } count() into \"total\" } df.groupBy { \"name\"[\"firstName\"] }.aggregate { pivot(\"city\").aggregate(separate \u003d true) { mean(\"age\") into \"mean age\" count() into \"count\" } count() into \"total\" }","pageTitle":"Aggregate pivot","metaDescription":"","type":"Documentation","breadcrumbs":"operations.md|Operations///aggregate.md|Aggregate"}